---
sidebar_position: 1
---

# Введение в SIEM

**SIEM** (Security Information and Event Management) — система управления информацией и событиями безопасности.

## Что такое SIEM?

SIEM объединяет две функции:
- **SIM** (Security Information Management) — сбор и хранение логов
- **SEM** (Security Event Management) — анализ и корреляция в реальном времени

```
┌─────────────────────────────────────────────────────────────────┐
│                         SIEM СИСТЕМА                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐          │
│   │ Firewall│  │ Servers │  │   IDS   │  │   AD    │          │
│   └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘          │
│        │            │            │            │                 │
│        └────────────┴─────┬──────┴────────────┘                 │
│                           │                                     │
│                    ┌──────▼──────┐                              │
│                    │   Сбор      │                              │
│                    │   логов     │                              │
│                    └──────┬──────┘                              │
│                           │                                     │
│                    ┌──────▼──────┐                              │
│                    │ Нормализация│                              │
│                    │  и парсинг  │                              │
│                    └──────┬──────┘                              │
│                           │                                     │
│              ┌────────────┼────────────┐                        │
│              │            │            │                        │
│       ┌──────▼──────┐ ┌───▼───┐ ┌──────▼──────┐                │
│       │  Хранение   │ │Индекс │ │  Корреляция │                │
│       │   (БД)      │ │       │ │   правил    │                │
│       └─────────────┘ └───────┘ └──────┬──────┘                │
│                                        │                        │
│                                 ┌──────▼──────┐                 │
│                                 │   Алерты    │                 │
│                                 │  Dashboard  │                 │
│                                 └─────────────┘                 │
└─────────────────────────────────────────────────────────────────┘
```

## Ключевые функции

| Функция | Описание |
|---------|----------|
| **Сбор логов** | Агенты, Syslog, API, WMI, агентless |
| **Нормализация** | Приведение к единому формату |
| **Корреляция** | Связывание событий по правилам |
| **Хранение** | Долгосрочное хранение для расследований |
| **Алертинг** | Уведомления о подозрительной активности |
| **Дашборды** | Визуализация состояния безопасности |
| **Отчёты** | Compliance, аудит, статистика |

## Источники данных

### Сетевые устройства
- Firewalls (iptables, pfSense, Cisco ASA)
- IDS/IPS (Snort, Suricata)
- Routers, Switches
- VPN, Proxy

### Серверы
- Windows Event Log
- Linux Syslog, journald
- Web-серверы (Apache, Nginx)
- Базы данных

### Приложения
- Антивирусы
- DLP системы
- Identity Management
- Cloud сервисы (AWS, Azure)

### Endpoint
- EDR агенты
- Sysmon
- HIDS (OSSEC, Wazuh)

## Популярные SIEM системы

### Open Source

| Система | Описание | Стек |
|---------|----------|------|
| **Wazuh** | HIDS + SIEM, активное сообщество | Elastic Stack |
| **OSSEC** | Host-based IDS | Собственный |
| **Security Onion** | Полный NSM + SIEM | Elastic, Zeek, Suricata |
| **ELK Stack** | Elastic + Logstash + Kibana | Elastic |
| **Graylog** | Централизованные логи | MongoDB, Elastic |

### Коммерческие

| Система | Компания | Особенности |
|---------|----------|-------------|
| **Splunk** | Splunk Inc. | Лидер рынка, мощный SPL |
| **QRadar** | IBM | Сильная корреляция |
| **ArcSight** | Micro Focus | Enterprise-класс |
| **LogRhythm** | LogRhythm | AI/ML аналитика |
| **Microsoft Sentinel** | Microsoft | Облачный, Azure интеграция |

## Жизненный цикл события

```
1. Генерация     → Событие происходит на источнике
       ↓
2. Сбор          → Агент/Syslog отправляет в SIEM
       ↓
3. Парсинг       → Извлечение полей из сырого лога
       ↓
4. Нормализация  → Приведение к единой схеме
       ↓
5. Обогащение    → GeoIP, Threat Intel, Asset info
       ↓
6. Корреляция    → Сопоставление с правилами
       ↓
7. Алерт         → Уведомление аналитика
       ↓
8. Расследование → Анализ, поиск по логам
       ↓
9. Реагирование  → Блокировка, изоляция, отчёт
```

## Метрики эффективности

| Метрика | Описание | Цель |
|---------|----------|------|
| **MTTD** | Mean Time to Detect | < 1 час |
| **MTTR** | Mean Time to Respond | < 4 часа |
| **EPS** | Events Per Second | Зависит от инфраструктуры |
| **False Positive Rate** | Ложные срабатывания | < 10% |
| **Coverage** | Покрытие источников | > 90% |

## Compliance и стандарты

SIEM помогает соответствовать:

- **PCI DSS** — требования 10.x (логирование)
- **HIPAA** — аудит доступа к PHI
- **SOX** — контроль финансовых систем
- **GDPR** — мониторинг доступа к персданным
- **ISO 27001** — A.12.4 (логирование)
- **ГОСТ Р 57580** — требования к мониторингу

## Рекомендации по внедрению

1. **Определите scope** — какие системы мониторить
2. **Приоритизируйте источники** — критичные в первую очередь
3. **Настройте retention** — сколько хранить логи
4. **Создайте use cases** — что именно детектить
5. **Tune правила** — уменьшите false positives
6. **Обучите команду** — SOC аналитики должны знать систему
7. **Автоматизируйте** — SOAR для типовых инцидентов
