---
sidebar_position: 5
---

# Хеш-функции

Хеш-функция преобразует данные произвольной длины в строку фиксированной длины (дайджест).

## Свойства криптографических хеш-функций

| Свойство | Описание |
|----------|----------|
| **Детерминированность** | Одинаковый вход → одинаковый выход |
| **Быстрота** | Эффективное вычисление |
| **Односторонность** | Невозможно восстановить исходные данные |
| **Лавинный эффект** | Малое изменение входа → большое изменение выхода |
| **Устойчивость к коллизиям** | Сложно найти два входа с одинаковым хешем |

## Семейство SHA

### SHA-2

| Алгоритм | Размер хеша | Статус |
|----------|-------------|--------|
| SHA-224 | 224 бит | Допустим |
| SHA-256 | 256 бит | ✅ Рекомендуется |
| SHA-384 | 384 бит | ✅ Рекомендуется |
| SHA-512 | 512 бит | ✅ Рекомендуется |

```python
import hashlib

data = b"Hello, World!"
hash_sha256 = hashlib.sha256(data).hexdigest()
# 'dffd6021bb2bd5b0af676290809ec3a53191dd81c7f70a4b28688a362182986f'
```

### SHA-3 (Keccak)

Альтернатива SHA-2 с другой внутренней структурой (губка).

## ГОСТ Р 34.11-2012 «Стрибог»

Российский стандарт хеширования.

| Вариант | Размер хеша |
|---------|-------------|
| Стрибог-256 | 256 бит |
| Стрибог-512 | 512 бит |

```python
from pygost.gost34112012 import GOST34112012

data = b"Hello, World!"
hash_streebog = GOST34112012(data, digest_size=32).hexdigest()
```

## Применение

### Хранение паролей

:::danger Никогда не храните пароли в открытом виде!
Используйте специализированные функции: **bcrypt**, **Argon2**, **scrypt**.
:::

```python
import bcrypt

password = b"user_password"
salt = bcrypt.gensalt(rounds=12)
hashed = bcrypt.hashpw(password, salt)

# Проверка
bcrypt.checkpw(password, hashed)  # True
```

### HMAC (Hash-based MAC)

Код аутентификации сообщения на основе хеша.

```python
import hmac
import hashlib

key = b"secret_key"
message = b"data to authenticate"
mac = hmac.new(key, message, hashlib.sha256).hexdigest()
```

### Цифровые отпечатки

- Проверка целостности файлов
- Контроль версий (Git использует SHA-1)
- Блокчейн (цепочка хешей)
