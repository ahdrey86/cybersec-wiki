---
sidebar_position: 6
---

import DESVisualizer from '@site/src/components/ciphers/DESVisualizer';

# DES (Data Encryption Standard)

Исторический блочный шифр, принятый как стандарт США в 1977 году. **Устарел и небезопасен**.

## Интерактивная визуализация

<DESVisualizer />

## Характеристики

| Параметр | Значение |
|----------|----------|
| Размер блока | 64 бит |
| Размер ключа | 56 бит (+ 8 бит чётности = 64) |
| Раундов | 16 |
| Структура | Сеть Фейстеля |

## История

- **1973**: Конкурс NIST на стандарт шифрования
- **1976**: IBM представляет Lucifer → DES
- **1977**: Принят как FIPS 46
- **1999**: Взломан за 22 часа (EFF Deep Crack)
- **2002**: Заменён на AES

## Структура DES

### Общая схема

```
┌─────────────────────────────────┐
│        Входной блок (64)        │
└─────────────────────────────────┘
                │
        ┌───────▼───────┐
        │ Начальная IP  │
        └───────┬───────┘
                │
        ┌───────┴───────┐
        │   L₀  │   R₀  │  (по 32 бит)
        └───────┴───────┘
                │
        ┌───────▼───────┐
        │  16 раундов   │ ◄── K₁...K₁₆
        │   Фейстеля    │
        └───────┬───────┘
                │
        ┌───────┴───────┐
        │   R₁₆ │  L₁₆  │  (swap)
        └───────┴───────┘
                │
        ┌───────▼───────┐
        │  Конечная IP⁻¹│
        └───────┬───────┘
                │
┌─────────────────────────────────┐
│       Шифротекст (64)           │
└─────────────────────────────────┘
```

### Один раунд Фейстеля

```
L_{i-1}                R_{i-1}
   │                      │
   │    ┌─────────────────┤
   │    │                 │
   │    ▼                 │
   │  ┌───┐               │
   │  │ F │◄───── K_i     │
   │  └─┬─┘               │
   │    │                 │
   ▼    ▼                 ▼
 ┌───────┐              ┌───┐
 │  XOR  │              │   │
 └───┬───┘              │   │
     │                  │   │
     ▼                  ▼   │
   L_i = R_{i-1}      R_i = L_{i-1} ⊕ F(R_{i-1}, K_i)
```

## Функция F

### Структура функции F(R, K)

```
      R (32 бит)
          │
    ┌─────▼─────┐
    │ E-расшир. │  32 → 48 бит
    └─────┬─────┘
          │
    ┌─────▼─────┐
    │    XOR    │◄── K (48 бит)
    └─────┬─────┘
          │
    ┌─────▼─────┐
    │  S-boxes  │  48 → 32 бит (8 × 6→4)
    └─────┬─────┘
          │
    ┌─────▼─────┐
    │     P     │  перестановка
    └─────┬─────┘
          │
        (32 бит)
```

### E-расширение

Расширяет 32 бита до 48 бит путём дублирования некоторых битов:

```
Вход (32): 1  2  3  4  5  6  7  8  9 10 11 12...
Выход(48): 32 1  2  3  4  5  4  5  6  7  8  9...
```

### S-Boxes

8 S-блоков, каждый преобразует 6 бит в 4 бит:
- Биты 1 и 6 → номер строки (0-3)
- Биты 2-5 → номер столбца (0-15)

```
S-Box 1:
    0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F
0: 14  4 13  1  2 15 11  8  3 10  6 12  5  9  0  7
1:  0 15  7  4 14  2 13  1 10  6 12 11  9  5  3  8
2:  4  1 14  8 13  6  2 11 15 12  9  7  3 10  5  0
3: 15 12  8  2  4  9  1  7  5 11  3 14 10  0  6 13
```

### P-перестановка

Переставляет 32 бита результата S-boxes:

```
16  7 20 21 29 12 28 17  1 15 23 26  5 18 31 10
 2  8 24 14 32 27  3  9 19 13 30  6 22 11  4 25
```

## Расписание ключей

### Подготовка ключа

1. **PC-1** (Permuted Choice 1): 64 → 56 бит (удаление битов чётности)
2. Разделение на C₀ и D₀ (по 28 бит)
3. Циклические сдвиги влево (1 или 2 бита)
4. **PC-2**: 56 → 48 бит для каждого раунда

### Сдвиги

| Раунд | Сдвиг |
|-------|-------|
| 1, 2, 9, 16 | 1 бит |
| Остальные | 2 бита |

## 3DES (Triple DES)

Усиление DES тройным применением:

### EDE (Encrypt-Decrypt-Encrypt)

```
C = E_{K3}(D_{K2}(E_{K1}(P)))
```

### Варианты

| Вариант | Ключи | Эффективная длина |
|---------|-------|-------------------|
| 3-key | K1 ≠ K2 ≠ K3 | 168 бит |
| 2-key | K1 = K3 ≠ K2 | 112 бит |

### Совместимость с DES

При K1 = K2 = K3: 3DES = DES

## Атаки на DES

### Brute Force

| Год | Время | Метод |
|-----|-------|-------|
| 1997 | 96 дней | Distributed.net |
| 1998 | 56 часов | EFF Deep Crack ($250k) |
| 1999 | 22 часа | Deep Crack + distributed |

### Дифференциальный криптоанализ

- **Biham & Shamir (1990)**
- 2⁴⁷ выбранных открытых текстов
- Меньше, чем brute force (2⁵⁶)

### Линейный криптоанализ

- **Matsui (1993)**
- 2⁴³ известных открытых текстов
- Практически осуществимо

## Слабые ключи

Некоторые ключи порождают идентичные подключи:

| Тип | Количество | Пример |
|-----|------------|--------|
| Слабые | 4 | 0x0000000000000000 |
| Полуслабые | 12 | Пары с K₁ = K₁₆ |
| Возможно слабые | 48 | — |

## Почему DES устарел

1. **56-битный ключ** — слишком короткий
2. **64-битный блок** — уязвим к birthday attacks
3. **Известные атаки** — дифференциальный/линейный криптоанализ
4. **Медленный** — по сравнению с AES

## Сравнение

| Параметр | DES | 3DES | AES-128 |
|----------|-----|------|---------|
| Ключ | 56 | 112/168 | 128 |
| Блок | 64 | 64 | 128 |
| Раунды | 16 | 48 | 10 |
| Структура | Фейстель | Фейстель | SP-сеть |
| Статус | ❌ | ⚠️ | ✅ |

## Использование сегодня

:::warning Не используйте DES!
DES следует использовать только для совместимости с legacy-системами.
:::

- **3DES** всё ещё встречается в банковских системах
- Переход на **AES** обязателен для новых систем
- PCI DSS запретил DES с 2010 года
