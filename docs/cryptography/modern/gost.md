---
sidebar_position: 4
---

import KuznechikDemo from '@site/src/components/ciphers/KuznechikDemo';
import StreebogDemo from '@site/src/components/ciphers/StreebogDemo';
import Gost28147Demo from '@site/src/components/ciphers/Gost28147Demo';
import MagmaSBox from '@site/src/components/ciphers/MagmaSBox';

# Российские криптоалгоритмы (ГОСТ)

Отечественные стандарты криптографической защиты информации.

## Обзор стандартов

| Стандарт | Алгоритм | Тип | Блок | Ключ |
|----------|----------|-----|------|------|
| ГОСТ 28147-89 | — | Блочный шифр | 64 бит | 256 бит |
| ГОСТ Р 34.12-2015 | Магма | Блочный шифр | 64 бит | 256 бит |
| ГОСТ Р 34.12-2015 | Кузнечик | Блочный шифр | 128 бит | 256 бит |
| ГОСТ Р 34.11-2012 | Стрибог | Хеш-функция | 512 бит | 256/512 бит |
| ГОСТ Р 34.10-2012 | — | ЭЦП | — | 256/512 бит |

## ГОСТ 28147-89

Советский/российский стандарт блочного шифрования, действовавший с 1989 года.

### Характеристики

- **Блок:** 64 бита
- **Ключ:** 256 бит (8 подключей по 32 бита)
- **Раунды:** 32
- **Структура:** Сеть Фейстеля

### Демонстрация раунда

<Gost28147Demo />

### Особенности

1. **Сменные S-блоки** — не зафиксированы в стандарте
2. **Простая структура** — легко реализуется аппаратно
3. **Высокое быстродействие** — минимум операций на раунд

### Расписание ключей

```
256-битный ключ = K₀ || K₁ || K₂ || K₃ || K₄ || K₅ || K₆ || K₇

Раунды 1-8:   K₀, K₁, K₂, K₃, K₄, K₅, K₆, K₇
Раунды 9-16:  K₀, K₁, K₂, K₃, K₄, K₅, K₆, K₇
Раунды 17-24: K₀, K₁, K₂, K₃, K₄, K₅, K₆, K₇
Раунды 25-32: K₇, K₆, K₅, K₄, K₃, K₂, K₁, K₀
```

## ГОСТ Р 34.12-2015 «Магма»

Модернизированная версия ГОСТ 28147-89 с фиксированными S-блоками.

### S-блок замены

<MagmaSBox />

### Отличия от ГОСТ 28147-89

| Параметр | ГОСТ 28147-89 | Магма |
|----------|---------------|-------|
| S-блоки | Сменные | Фиксированные |
| Порядок байт | Big-endian | Little-endian |
| Стандартизация S-блоков | Отдельные документы | В основном стандарте |

## ГОСТ Р 34.12-2015 «Кузнечик»

Современный российский блочный шифр с увеличенным размером блока.

### Характеристики

- **Блок:** 128 бит
- **Ключ:** 256 бит
- **Раунды:** 10
- **Структура:** SP-сеть (Substitution-Permutation)

### Демонстрация преобразований

<KuznechikDemo />

### Структура раунда

```
┌─────────────────────────────────────────┐
│            Входной блок (128 бит)       │
└────────────────────┬────────────────────┘
                     │
              ┌──────▼──────┐
              │   X (XOR)   │ ← Раундовый ключ
              └──────┬──────┘
                     │
              ┌──────▼──────┐
              │  S (замена) │ ← Нелинейное преобразование π
              └──────┬──────┘
                     │
              ┌──────▼──────┐
              │ L (линейное)│ ← Умножение в GF(2⁸)
              └──────┬──────┘
                     │
┌────────────────────▼────────────────────┐
│           Выходной блок (128 бит)       │
└─────────────────────────────────────────┘
```

### S-блок (π)

Нелинейная биективная замена 8→8 бит. Обеспечивает:
- Нелинейность 104 (из 128 максимум)
- Дифференциальная вероятность 2⁻⁶
- Линейная вероятность 2⁻⁵

### L-преобразование

Линейное преобразование на основе умножения в поле GF(2⁸):

```
L = R¹⁶ (16 итераций преобразования R)

R: (a₀, a₁, ..., a₁₅) → (l(a), a₀, a₁, ..., a₁₄)

где l(a) = ⊕ᵢ kᵢ · aᵢ в GF(2⁸)
```

## ГОСТ Р 34.11-2012 «Стрибог»

Российская хеш-функция, пришедшая на смену ГОСТ Р 34.11-94.

### Характеристики

- **Размер блока:** 512 бит
- **Размер хеша:** 256 или 512 бит
- **Раундов сжатия:** 12
- **Основа:** функция сжатия g на базе преобразований Кузнечика

### Демонстрация

<StreebogDemo />

### Структура

```
Стрибог использует конструкцию Меркла-Дамгора с:

1. Функция сжатия g(N, h, m):
   - N — счётчик обработанных бит
   - h — текущее значение хеша
   - m — блок сообщения

2. Преобразования внутри g:
   - X (XOR)
   - S (S-блок, как в Кузнечике)
   - P (перестановка байтов)
   - L (линейное преобразование)
```

### Режимы

| Режим | Размер хеша | IV |
|-------|-------------|-----|
| Стрибог-256 | 256 бит | 0x0101...01 (64 байта единиц) |
| Стрибог-512 | 512 бит | 0x0000...00 (64 нулевых байта) |

## ГОСТ Р 34.10-2012

Российский стандарт электронной цифровой подписи на эллиптических кривых.

### Параметры

| Вариант | Размер ключа | Размер подписи | Кривая |
|---------|--------------|----------------|--------|
| 256 бит | 256 бит | 512 бит | id-tc26-gost-3410-2012-256-paramSetA |
| 512 бит | 512 бит | 1024 бит | id-tc26-gost-3410-2012-512-paramSetA/B |

### Алгоритм подписи

```python
# Упрощённо:
# 1. Вычислить хеш сообщения h = Стрибог(M)
# 2. e = h mod q (q — порядок группы)
# 3. Выбрать случайное k
# 4. C = k * P (точка на кривой)
# 5. r = xc mod q
# 6. s = (r * d + k * e) mod q
# Подпись: (r, s)
```

## Режимы работы (ГОСТ Р 34.13-2015)

| Режим | Название | Особенности |
|-------|----------|-------------|
| ECB | Простая замена | Параллелизуется, детерминированный |
| CTR | Гаммирование | Потоковый, параллелизуется |
| OFB | Гаммирование с ОС | Потоковый |
| CBC | Сцепление | Зависимость блоков |
| CFB | Гаммирование с ОС по шифротексту | Самосинхронизация |
| MAC | Имитовставка | Аутентификация |

## Сравнение с международными стандартами

| Параметр | ГОСТ | AES | Примечание |
|----------|------|-----|------------|
| Блок Магма | 64 бит | 128 бит | AES безопаснее (birthday attack) |
| Блок Кузнечик | 128 бит | 128 бит | Одинаково |
| Ключ | 256 бит | 128/192/256 | ГОСТ всегда 256 |
| Раунды Магма | 32 | 10/12/14 | Больше раундов в ГОСТ |
| Раунды Кузнечик | 10 | 10/12/14 | Сопоставимо |
| Структура Магма | Фейстель | SP-сеть | Разные подходы |
| Структура Кузнечик | SP-сеть | SP-сеть | Похожи |

## Применение

### Где используются российские ГОСТ

- **Государственные информационные системы**
- **Банковская сфера** (защита платежей)
- **Электронный документооборот** (ЭЦП)
- **Защита персональных данных** (152-ФЗ)
- **Критическая инфраструктура** (187-ФЗ)

### Сертификация

Для использования в государственных системах криптосредства должны быть сертифицированы **ФСБ России**.

:::warning Важно
Демонстрационные реализации на этой странице предназначены только для обучения. Для реальной криптографической защиты используйте сертифицированные криптобиблиотеки.
:::

## Ресурсы

- [Стандарты ТК26](https://tc26.ru/) — Технический комитет по стандартизации криптографии
- [КриптоПро](https://cryptopro.ru/) — Сертифицированные СКЗИ
- [OpenSSL GOST](https://github.com/gost-engine/engine) — Open source реализация
